const lorem = new (require("lorem-ipsum").LoremIpsum)();
const http = require('http');
const fs = require('fs');
const uuidv4 = require('uuid/v4');
const axios = require('axios');

const MIN_ITEM_COUNT = 25;

(async () => {
    const {User, GalleryItem, sequelize} = await require("../models");
    await sequelize.query('SET FOREIGN_KEY_CHECKS = 0;');
    await GalleryItem.sync({ force: true });
    await User.sync({ force: true });
    const root = await User.findOrCreate({ where: { username: "root" }});
    let itemCount = await GalleryItem.count();
    while (itemCount <= MIN_ITEM_COUNT) {
        const fileName = uuidv4() + ".png";
        const path = __dirname + "/../vars/gallery-items/" + fileName;
        const file = fs.createWriteStream(path);
        // const response = await axios.get("https://picsum.photos/200/300");
        // response.pipe(file);
        const item = await GalleryItem.create({
            header: lorem.generateWords(2),
            content: lorem.generateParagraphs(1),
        });
        item.save();
        itemCount += 1
    }
})();
